<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Results – Daily Rhythms of Stress</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./conclusion.html" rel="next">
<link href="./data.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-cfd8c12f3696e32db20edb7e3d7fdd1a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./results.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Daily Rhythms of Stress</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/yanzzzk/edav-final-project" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./results.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#physiological-signatures-of-stress-wesad" id="toc-physiological-signatures-of-stress-wesad" class="nav-link active" data-scroll-target="#physiological-signatures-of-stress-wesad"><span class="header-section-number">3.1</span> 3.1 Physiological Signatures of Stress (WESAD)</a>
  <ul class="collapse">
  <li><a href="#eda-the-primary-stress-indicator" id="toc-eda-the-primary-stress-indicator" class="nav-link" data-scroll-target="#eda-the-primary-stress-indicator"><span class="header-section-number">3.1.1</span> EDA: The Primary Stress Indicator</a></li>
  <li><a href="#body-temperature-response" id="toc-body-temperature-response" class="nav-link" data-scroll-target="#body-temperature-response"><span class="header-section-number">3.1.2</span> Body Temperature Response</a></li>
  </ul></li>
  <li><a href="#individual-variations-in-heart-rate" id="toc-individual-variations-in-heart-rate" class="nav-link" data-scroll-target="#individual-variations-in-heart-rate"><span class="header-section-number">3.2</span> 3.2 Individual Variations in Heart Rate</a></li>
  <li><a href="#real-world-context-driving-stress" id="toc-real-world-context-driving-stress" class="nav-link" data-scroll-target="#real-world-context-driving-stress"><span class="header-section-number">3.3</span> 3.3 Real-World Context: Driving Stress</a></li>
  <li><a href="#multi-modal-correlations" id="toc-multi-modal-correlations" class="nav-link" data-scroll-target="#multi-modal-correlations"><span class="header-section-number">3.4</span> 3.4 Multi-modal Correlations</a></li>
  <li><a href="#temporal-dynamics-stress-recovery-rhythms" id="toc-temporal-dynamics-stress-recovery-rhythms" class="nav-link" data-scroll-target="#temporal-dynamics-stress-recovery-rhythms"><span class="header-section-number">3.5</span> 3.5 Temporal Dynamics: Stress &amp; Recovery Rhythms</a></li>
  <li><a href="#comparison-with-office-stress-swell" id="toc-comparison-with-office-stress-swell" class="nav-link" data-scroll-target="#comparison-with-office-stress-swell"><span class="header-section-number">3.6</span> 3.6 Comparison with Office Stress (SWELL)</a></li>
  <li><a href="#multidimensional-stress-separation" id="toc-multidimensional-stress-separation" class="nav-link" data-scroll-target="#multidimensional-stress-separation"><span class="header-section-number">3.7</span> 3.7 Multidimensional Stress Separation</a>
  <ul class="collapse">
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation"><span class="header-section-number">3.7.1</span> Interpretation</a></li>
  </ul></li>
  <li><a href="#cross-context-comparison-laboratory-vs.-real-world" id="toc-cross-context-comparison-laboratory-vs.-real-world" class="nav-link" data-scroll-target="#cross-context-comparison-laboratory-vs.-real-world"><span class="header-section-number">3.8</span> 3.8 Cross-Context Comparison: Laboratory vs.&nbsp;Real-World</a>
  <ul class="collapse">
  <li><a href="#context-specific-insights" id="toc-context-specific-insights" class="nav-link" data-scroll-target="#context-specific-insights"><span class="header-section-number">3.8.1</span> Context-Specific Insights</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/yanzzzk/edav-final-project/edit/main/results.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/yanzzzk/edav-final-project/blob/main/results.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this chapter, we conduct an exploratory data analysis (EDA) to investigate physiological responses to stress. We focus on comparing baseline states with stress conditions and analyzing differences across laboratory and real-world contexts.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(ggridges) <span class="co"># For ridge plots</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(viridis)  <span class="co"># For color accessible palettes</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(patchwork) <span class="co"># For combining plots</span></span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># 1. Load the cleaned data</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>wesad <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/clean/wesad_all_subjects.csv"</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a>road  <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/clean/road_hr_all.csv"</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a>swell <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/clean/swell_processed.csv"</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co"># 2. Set a consistent theme for "Audience Ready" style</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>my_theme <span class="ot">&lt;-</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>  <span class="fu">theme</span>(</span>
<span id="cb1-14"><a href="#cb1-14"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb1-15"><a href="#cb1-15"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"grey30"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb1-16"><a href="#cb1-16"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb1-17"><a href="#cb1-17"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb1-18"><a href="#cb1-18"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="physiological-signatures-of-stress-wesad" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="physiological-signatures-of-stress-wesad"><span class="header-section-number">3.1</span> 3.1 Physiological Signatures of Stress (WESAD)</h2>
<p>We first analyze the WESAD dataset to establish a “ground truth” for what stress looks like physiologically compared to baseline and amusement states.</p>
<section id="eda-the-primary-stress-indicator" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="eda-the-primary-stress-indicator"><span class="header-section-number">3.1.1</span> EDA: The Primary Stress Indicator</h3>
<p>Electrodermal Activity (EDA), also known as skin conductance, is a key indicator of physiological arousal. We expect stress to trigger significantly higher EDA levels.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Filter for key conditions (removing Meditation for clearer contrast)</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>wesad_main <span class="ot">&lt;-</span> wesad <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="fu">filter</span>(Condition <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Baseline"</span>, <span class="st">"Stress"</span>, <span class="st">"Amusement"</span>))</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co"># Graph 1: EDA Boxplot</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="fu">ggplot</span>(wesad_main, <span class="fu">aes</span>(<span class="at">x =</span> Condition, <span class="at">y =</span> EDA, <span class="at">fill =</span> Condition)) <span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.alpha =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"RdBu"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>)) <span class="sc">+</span> <span class="co"># Zoom in to ignore extreme outliers for better visibility</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>  <span class="fu">labs</span>(</span>
<span id="cb2-11"><a href="#cb2-11"></a>    <span class="at">title =</span> <span class="st">"Skin Conductance (EDA) by Condition"</span>,</span>
<span id="cb2-12"><a href="#cb2-12"></a>    <span class="at">subtitle =</span> <span class="st">"Stress elicits significantly higher EDA than Baseline"</span>,</span>
<span id="cb2-13"><a href="#cb2-13"></a>    <span class="at">y =</span> <span class="st">"EDA (μS)"</span>,</span>
<span id="cb2-14"><a href="#cb2-14"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>  ) <span class="sc">+</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>  my_theme <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results_files/figure-html/eda-boxplot-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Comparison of EDA across conditions. Stress shows a higher median and wider interquartile range.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="body-temperature-response" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="body-temperature-response"><span class="header-section-number">3.1.2</span> Body Temperature Response</h3>
<p>Does skin temperature drop or rise during stress? The “cold hands” phenomenon suggests a drop due to vasoconstriction, but metabolic activity might suggest a rise.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Graph 2: Temperature Violin Plot</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">ggplot</span>(wesad_main, <span class="fu">aes</span>(<span class="at">x =</span> Condition, <span class="at">y =</span> Temp, <span class="at">fill =</span> Condition)) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> median, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"RdBu"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="at">title =</span> <span class="st">"Skin Temperature Distribution"</span>,</span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="at">subtitle =</span> <span class="st">"Temperature varies less dramatically than EDA"</span>,</span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="at">y =</span> <span class="st">"Temperature (°C)"</span>,</span>
<span id="cb3-10"><a href="#cb3-10"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>  ) <span class="sc">+</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>  my_theme</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results_files/figure-html/temp-violin-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Violin plot of Skin Temperature. Note the subtle shifts in distribution.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="individual-variations-in-heart-rate" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="individual-variations-in-heart-rate"><span class="header-section-number">3.2</span> 3.2 Individual Variations in Heart Rate</h2>
<p>Physiological responses are highly personal. A stressor that spikes one person’s heart rate might not affect another’s as severely. Here we use Ridge Plots to visualize the heart rate (ECG) distribution for each subject.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Graph 3: ECG Ridge Plot</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">ggplot</span>(wesad_main, <span class="fu">aes</span>(<span class="at">x =</span> ECG, <span class="at">y =</span> Subject, <span class="at">fill =</span> Condition)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">scale =</span> <span class="fl">0.9</span>, <span class="at">rel_min_height =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray70"</span>, <span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span>)) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="at">title =</span> <span class="st">"ECG Signal Distribution by Subject"</span>,</span>
<span id="cb4-7"><a href="#cb4-7"></a>    <span class="at">subtitle =</span> <span class="st">"Comparing Baseline (Gray), Stress (Red), and Amusement (Blue)"</span>,</span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="at">x =</span> <span class="st">"ECG Amplitude (Normalized)"</span>,</span>
<span id="cb4-9"><a href="#cb4-9"></a>    <span class="at">y =</span> <span class="st">"Subject ID"</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>  ) <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>  <span class="fu">theme_ridges</span>() <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results_files/figure-html/ecg-ridges-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>ECG signal distributions for each subject. S2 and S3 show distinct shifts.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="real-world-context-driving-stress" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="real-world-context-driving-stress"><span class="header-section-number">3.3</span> 3.3 Real-World Context: Driving Stress</h2>
<p>How does heart rate variability look in a real-world driving task? We analyze the AffectiveROAD dataset to see heart rate patterns during different driving sessions.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Graph 4: Driving HR Bar Chart</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># Summarize data by DriveID</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>road_summary <span class="ot">&lt;-</span> road <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">group_by</span>(DriveID) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="fu">summarise</span>(</span>
<span id="cb5-6"><a href="#cb5-6"></a>    <span class="at">Mean_HR =</span> <span class="fu">mean</span>(HR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-7"><a href="#cb5-7"></a>    <span class="at">SD_HR =</span> <span class="fu">sd</span>(HR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co"># SD is a proxy for HRV (Heart Rate Variability)</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Mean_HR))</span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="fu">ggplot</span>(road_summary, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(DriveID, Mean_HR), <span class="at">y =</span> Mean_HR)) <span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Mean_HR <span class="sc">-</span> SD_HR, <span class="at">ymax =</span> Mean_HR <span class="sc">+</span> SD_HR), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-16"><a href="#cb5-16"></a>    <span class="at">title =</span> <span class="st">"Heart Rate during Driving Sessions"</span>,</span>
<span id="cb5-17"><a href="#cb5-17"></a>    <span class="at">subtitle =</span> <span class="st">"Error bars represent Standard Deviation (Proxy for HRV)"</span>,</span>
<span id="cb5-18"><a href="#cb5-18"></a>    <span class="at">y =</span> <span class="st">"Heart Rate (BPM)"</span>,</span>
<span id="cb5-19"><a href="#cb5-19"></a>    <span class="at">x =</span> <span class="st">"Driving Session"</span></span>
<span id="cb5-20"><a href="#cb5-20"></a>  ) <span class="sc">+</span></span>
<span id="cb5-21"><a href="#cb5-21"></a>  my_theme</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results_files/figure-html/driving-hr-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Average Heart Rate across different driving sessions.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="multi-modal-correlations" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="multi-modal-correlations"><span class="header-section-number">3.4</span> 3.4 Multi-modal Correlations</h2>
<p>Do physiological signals synchronize during stress? We examine the correlation between Heart Rate (ECG), Skin Conductance (EDA), and Body Temperature (Temp) to see if they move in tandem.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># 1. Select numeric physiological columns</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>cor_data <span class="ot">&lt;-</span> wesad_main <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">select</span>(EDA, Temp, ECG)</span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co"># 2. Compute correlation matrix</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(cor_data, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co"># 3. Transform to long format for ggplot</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>cor_melted <span class="ot">&lt;-</span> cor_matrix <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Var1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Var1, <span class="at">names_to =</span> <span class="st">"Var2"</span>, <span class="at">values_to =</span> <span class="st">"Correlation"</span>)</span>
<span id="cb6-13"><a href="#cb6-13"></a></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co"># 4. Plot Heatmap</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="fu">ggplot</span>(cor_melted, <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb6-16"><a href="#cb6-16"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb6-17"><a href="#cb6-17"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Correlation, <span class="dv">2</span>)), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb6-18"><a href="#cb6-18"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"#377EB8"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#E41A1C"</span>, </span>
<span id="cb6-19"><a href="#cb6-19"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>  <span class="fu">labs</span>(</span>
<span id="cb6-21"><a href="#cb6-21"></a>    <span class="at">title =</span> <span class="st">"Correlation of Physiological Signals"</span>,</span>
<span id="cb6-22"><a href="#cb6-22"></a>    <span class="at">subtitle =</span> <span class="st">"EDA and Temperature show distinct relationship patterns compared to ECG"</span>,</span>
<span id="cb6-23"><a href="#cb6-23"></a>    <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span></span>
<span id="cb6-24"><a href="#cb6-24"></a>  ) <span class="sc">+</span></span>
<span id="cb6-25"><a href="#cb6-25"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-26"><a href="#cb6-26"></a>  <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results_files/figure-html/correlation-heatmap-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Correlation Matrix of Physiological Signals. Red indicates positive correlation, Blue indicates negative.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="temporal-dynamics-stress-recovery-rhythms" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="temporal-dynamics-stress-recovery-rhythms"><span class="header-section-number">3.5</span> 3.5 Temporal Dynamics: Stress &amp; Recovery Rhythms</h2>
<p>A key goal of this project is to explore the daily rhythms of stress. Here, we zoom in on a single subject (S2) to visualize how their physiological state evolves over time, transitioning from Baseline to Stress and finally to Amusement (Recovery).</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># 1. Filter for Subject S2 and create a Time axis</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co"># Since we downsampled to ~10Hz, each row is approx 0.1 seconds.</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>subject_s2 <span class="ot">&lt;-</span> wesad <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">filter</span>(Subject <span class="sc">==</span> <span class="st">"S2"</span>, Condition <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Baseline"</span>, <span class="st">"Stress"</span>, <span class="st">"Amusement"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="fu">mutate</span>(<span class="at">Time_Sec =</span> <span class="fu">row_number</span>() <span class="sc">/</span> <span class="dv">10</span>) <span class="co"># Create time in seconds</span></span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co"># 2. Visualization</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co"># We want to highlight the "Stress" period. </span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co"># Let's plot EDA over time, coloring the line by Condition.</span></span>
<span id="cb7-10"><a href="#cb7-10"></a></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="fu">ggplot</span>(subject_s2, <span class="fu">aes</span>(<span class="at">x =</span> Time_Sec, <span class="at">y =</span> EDA, <span class="at">color =</span> Condition)) <span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Baseline"</span> <span class="ot">=</span> <span class="st">"gray50"</span>, <span class="st">"Stress"</span> <span class="ot">=</span> <span class="st">"#E41A1C"</span>, <span class="st">"Amusement"</span> <span class="ot">=</span> <span class="st">"#377EB8"</span>)) <span class="sc">+</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-15"><a href="#cb7-15"></a>    <span class="at">title =</span> <span class="st">"Physiological Stress Response Over Time (Subject S2)"</span>,</span>
<span id="cb7-16"><a href="#cb7-16"></a>    <span class="at">subtitle =</span> <span class="st">"Tracking Electrodermal Activity (EDA) through different experimental phases"</span>,</span>
<span id="cb7-17"><a href="#cb7-17"></a>    <span class="at">x =</span> <span class="st">"Time (seconds)"</span>,</span>
<span id="cb7-18"><a href="#cb7-18"></a>    <span class="at">y =</span> <span class="st">"Skin Conductance (μS)"</span>,</span>
<span id="cb7-19"><a href="#cb7-19"></a>    <span class="at">caption =</span> <span class="st">"Red indicates the Stress phase, clearly marked by a surge in EDA."</span></span>
<span id="cb7-20"><a href="#cb7-20"></a>  ) <span class="sc">+</span></span>
<span id="cb7-21"><a href="#cb7-21"></a>  my_theme <span class="sc">+</span></span>
<span id="cb7-22"><a href="#cb7-22"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results_files/figure-html/time-series-s2-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Temporal evolution of EDA and Temperature for Subject S2. The shaded regions represent the Stress condition.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="comparison-with-office-stress-swell" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="comparison-with-office-stress-swell"><span class="header-section-number">3.6</span> 3.6 Comparison with Office Stress (SWELL)</h2>
<p>Finally, we briefly examine the SWELL-KW dataset to understand the feature distribution in an office setting.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Quick inspection of SWELL dataset features</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co"># We select numeric columns that might represent heart rate or skin conductance</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co"># Note: SWELL column names depend on the specific feature set used. </span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># Here we visualize the first few available numeric columns as an exploratory step.</span></span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co"># Select only numeric columns for a quick overview</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>swell_numeric <span class="ot">&lt;-</span> swell <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Feature"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>  <span class="co"># Just pick top 4 features to plot to avoid overcrowding</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>  <span class="fu">filter</span>(Feature <span class="sc">%in%</span> <span class="fu">unique</span>(Feature)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb8-12"><a href="#cb8-12"></a></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="fu">ggplot</span>(swell_numeric, <span class="fu">aes</span>(<span class="at">x =</span> Value)) <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"forestgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Feature, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>  <span class="fu">labs</span>(</span>
<span id="cb8-17"><a href="#cb8-17"></a>    <span class="at">title =</span> <span class="st">"Feature Distributions in SWELL (Office) Dataset"</span>,</span>
<span id="cb8-18"><a href="#cb8-18"></a>    <span class="at">subtitle =</span> <span class="st">"Exploratory histograms of physiological/behavioral features"</span>,</span>
<span id="cb8-19"><a href="#cb8-19"></a>    <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb8-20"><a href="#cb8-20"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb8-21"><a href="#cb8-21"></a>  ) <span class="sc">+</span></span>
<span id="cb8-22"><a href="#cb8-22"></a>  my_theme</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="results_files/figure-html/swell-overview-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="multidimensional-stress-separation" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="multidimensional-stress-separation"><span class="header-section-number">3.7</span> 3.7 Multidimensional Stress Separation</h2>
<p>Can we distinguish “Stress” from “Baseline” by examining multiple physiological signals simultaneously? Here we visualize the <strong>2D feature space</strong> plotting Temperature against EDA to reveal how stress occupies a distinct physiological region.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Create 2D scatter plot with density contours</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">ggplot</span>(wesad_main, <span class="fu">aes</span>(<span class="at">x =</span> Temp, <span class="at">y =</span> EDA, <span class="at">color =</span> Condition)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="fu">stat_ellipse</span>(<span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb9-6"><a href="#cb9-6"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Baseline"</span> <span class="ot">=</span> <span class="st">"#4DAF4A"</span>, <span class="st">"Stress"</span> <span class="ot">=</span> <span class="st">"#E41A1C"</span>, <span class="st">"Amusement"</span> <span class="ot">=</span> <span class="st">"#377EB8"</span>),</span>
<span id="cb9-7"><a href="#cb9-7"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Baseline (Calm)"</span>, <span class="st">"Stress (Aroused)"</span>, <span class="st">"Amusement (Relaxed)"</span>)</span>
<span id="cb9-8"><a href="#cb9-8"></a>  ) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-10"><a href="#cb9-10"></a>    <span class="at">title =</span> <span class="st">"Physiological Feature Space: Temperature vs. EDA"</span>,</span>
<span id="cb9-11"><a href="#cb9-11"></a>    <span class="at">subtitle =</span> <span class="st">"Stress is characterized by elevated EDA with moderate temperature variation"</span>,</span>
<span id="cb9-12"><a href="#cb9-12"></a>    <span class="at">x =</span> <span class="st">"Skin Temperature (°C)"</span>,</span>
<span id="cb9-13"><a href="#cb9-13"></a>    <span class="at">y =</span> <span class="st">"Electrodermal Activity (μS)"</span>,</span>
<span id="cb9-14"><a href="#cb9-14"></a>    <span class="at">color =</span> <span class="st">"Experimental Condition"</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>  ) <span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16"></a>  my_theme <span class="sc">+</span></span>
<span id="cb9-17"><a href="#cb9-17"></a>  <span class="fu">theme</span>(</span>
<span id="cb9-18"><a href="#cb9-18"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb9-19"><a href="#cb9-19"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb9-20"><a href="#cb9-20"></a>  ) <span class="sc">+</span></span>
<span id="cb9-21"><a href="#cb9-21"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results_files/figure-html/feature-scatter-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Scatter plot of Skin Temperature vs.&nbsp;EDA. Stress (Red) clusters in a distinct region with elevated EDA levels.</figcaption>
</figure>
</div>
</div>
</div>
<section id="interpretation" class="level3" data-number="3.7.1">
<h3 data-number="3.7.1" class="anchored" data-anchor-id="interpretation"><span class="header-section-number">3.7.1</span> Interpretation</h3>
<p>The scatter plot reveals clear <strong>clustering patterns</strong> in the physiological feature space:</p>
<ul>
<li><strong>Stress (Red)</strong>: High EDA values (&gt;5 μS) with temperature clustered around 32-34°C</li>
<li><strong>Baseline (Green)</strong>: Lower EDA (&lt;5 μS) and slightly cooler temperature</li>
<li><strong>Amusement (Blue)</strong>: Moderate EDA with the widest temperature distribution</li>
</ul>
<p>The 95% confidence ellipses show minimal overlap between Stress and Baseline, suggesting these signals could effectively classify stress states in a machine learning model.</p>
<hr>
</section>
</section>
<section id="cross-context-comparison-laboratory-vs.-real-world" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="cross-context-comparison-laboratory-vs.-real-world"><span class="header-section-number">3.8</span> 3.8 Cross-Context Comparison: Laboratory vs.&nbsp;Real-World</h2>
<p>How do physiological responses differ between controlled laboratory settings and naturalistic environments? We compare heart rate patterns from the WESAD lab study with the AffectiveROAD driving dataset.</p>
<div class="cell">
<details class="code-fold">
<summary>Show Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Prepare lab data (WESAD ECG - proxy for heart activity)</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>lab_data <span class="ot">&lt;-</span> wesad_main <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">filter</span>(Condition <span class="sc">==</span> <span class="st">"Stress"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">select</span>(ECG) <span class="sc">%&gt;%</span> </span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-6"><a href="#cb10-6"></a>    <span class="at">Context =</span> <span class="st">"Laboratory (WESAD)"</span>,</span>
<span id="cb10-7"><a href="#cb10-7"></a>    <span class="at">Signal_Type =</span> <span class="st">"ECG Amplitude"</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="fu">rename</span>(<span class="at">Value =</span> ECG)</span>
<span id="cb10-10"><a href="#cb10-10"></a></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co"># Prepare real-world data (AffectiveROAD Heart Rate)</span></span>
<span id="cb10-12"><a href="#cb10-12"></a>realworld_data <span class="ot">&lt;-</span> road <span class="sc">%&gt;%</span> </span>
<span id="cb10-13"><a href="#cb10-13"></a>  <span class="fu">select</span>(HR) <span class="sc">%&gt;%</span> </span>
<span id="cb10-14"><a href="#cb10-14"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-15"><a href="#cb10-15"></a>    <span class="at">Context =</span> <span class="st">"Real-World (Driving)"</span>,</span>
<span id="cb10-16"><a href="#cb10-16"></a>    <span class="at">Signal_Type =</span> <span class="st">"Heart Rate (BPM)"</span></span>
<span id="cb10-17"><a href="#cb10-17"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-18"><a href="#cb10-18"></a>  <span class="fu">rename</span>(<span class="at">Value =</span> HR) <span class="sc">%&gt;%</span></span>
<span id="cb10-19"><a href="#cb10-19"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value))</span>
<span id="cb10-20"><a href="#cb10-20"></a></span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="co"># Combine datasets</span></span>
<span id="cb10-22"><a href="#cb10-22"></a>comparison_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(lab_data, realworld_data)</span>
<span id="cb10-23"><a href="#cb10-23"></a></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="co"># Create side-by-side density plots</span></span>
<span id="cb10-25"><a href="#cb10-25"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(comparison_data, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Context)) <span class="sc">+</span></span>
<span id="cb10-26"><a href="#cb10-26"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-27"><a href="#cb10-27"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Laboratory (WESAD)"</span> <span class="ot">=</span> <span class="st">"#FF6B6B"</span>, </span>
<span id="cb10-28"><a href="#cb10-28"></a>                                 <span class="st">"Real-World (Driving)"</span> <span class="ot">=</span> <span class="st">"#4ECDC4"</span>)) <span class="sc">+</span></span>
<span id="cb10-29"><a href="#cb10-29"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Context, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb10-30"><a href="#cb10-30"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-31"><a href="#cb10-31"></a>    <span class="at">title =</span> <span class="st">"Physiological Signal Distributions: Lab vs. Real-World Contexts"</span>,</span>
<span id="cb10-32"><a href="#cb10-32"></a>    <span class="at">subtitle =</span> <span class="st">"Comparing controlled stress induction (WESAD) with naturalistic driving stress (AffectiveROAD)"</span>,</span>
<span id="cb10-33"><a href="#cb10-33"></a>    <span class="at">x =</span> <span class="st">"Signal Value (context-specific units)"</span>,</span>
<span id="cb10-34"><a href="#cb10-34"></a>    <span class="at">y =</span> <span class="st">"Probability Density"</span>,</span>
<span id="cb10-35"><a href="#cb10-35"></a>    <span class="at">caption =</span> <span class="st">"Note: Different measurement modalities (ECG vs. HR) and units - focus on distribution shape"</span></span>
<span id="cb10-36"><a href="#cb10-36"></a>  ) <span class="sc">+</span></span>
<span id="cb10-37"><a href="#cb10-37"></a>  my_theme <span class="sc">+</span></span>
<span id="cb10-38"><a href="#cb10-38"></a>  <span class="fu">theme</span>(</span>
<span id="cb10-39"><a href="#cb10-39"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb10-40"><a href="#cb10-40"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"gray90"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb10-41"><a href="#cb10-41"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb10-42"><a href="#cb10-42"></a>  )</span>
<span id="cb10-43"><a href="#cb10-43"></a></span>
<span id="cb10-44"><a href="#cb10-44"></a><span class="fu">print</span>(p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="results_files/figure-html/cross-context-comparison-1.png" class="img-fluid figure-img" width="1152"></p>
<figcaption>Distribution comparison: Laboratory ECG (WESAD) vs.&nbsp;Real-world Heart Rate (Driving)</figcaption>
</figure>
</div>
</div>
</div>
<section id="context-specific-insights" class="level3" data-number="3.8.1">
<h3 data-number="3.8.1" class="anchored" data-anchor-id="context-specific-insights"><span class="header-section-number">3.8.1</span> Context-Specific Insights</h3>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Descriptive Statistics by Context</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Statistic</th>
<th style="text-align: right;">Lab (ECG)</th>
<th style="text-align: right;">Driving (HR)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mean</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">82.35</td>
</tr>
<tr class="even">
<td style="text-align: left;">Std Dev</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">14.30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Median</td>
<td style="text-align: right;">-0.02</td>
<td style="text-align: right;">80.62</td>
</tr>
<tr class="even">
<td style="text-align: left;">IQR</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">14.21</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Key Findings:</strong></p>
<ul>
<li><strong>Laboratory stress</strong> (WESAD) shows more uniform distributions due to controlled experimental protocols</li>
<li><strong>Real-world driving</strong> exhibits higher variability, reflecting diverse traffic conditions and individual driving styles</li>
<li>Both contexts demonstrate elevated physiological arousal, but with distinct signal characteristics</li>
</ul>
<p>This comparison highlights the importance of validating stress detection models across multiple contexts - what works in the lab may require adaptation for real-world deployment.</p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data.html" class="pagination-link" aria-label="Data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./conclusion.html" class="pagination-link" aria-label="Conclusion">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Conclusion</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb11" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu"># Results</span></span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a>In this chapter, we conduct an exploratory data analysis (EDA) to investigate physiological responses to stress. We focus on comparing baseline states with stress conditions and analyzing differences across laboratory and real-world contexts.</span>
<span id="cb11-4"><a href="#cb11-4"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="in">```{r}</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#| label: setup-results</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#| message: false</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#| warning: false</span></span>
<span id="cb11-11"><a href="#cb11-11"></a></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="fu">library</span>(ggridges) <span class="co"># For ridge plots</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="fu">library</span>(viridis)  <span class="co"># For color accessible palettes</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="fu">library</span>(patchwork) <span class="co"># For combining plots</span></span>
<span id="cb11-16"><a href="#cb11-16"></a></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="co"># 1. Load the cleaned data</span></span>
<span id="cb11-18"><a href="#cb11-18"></a>wesad <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/clean/wesad_all_subjects.csv"</span>)</span>
<span id="cb11-19"><a href="#cb11-19"></a>road  <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/clean/road_hr_all.csv"</span>)</span>
<span id="cb11-20"><a href="#cb11-20"></a>swell <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/clean/swell_processed.csv"</span>)</span>
<span id="cb11-21"><a href="#cb11-21"></a></span>
<span id="cb11-22"><a href="#cb11-22"></a><span class="co"># 2. Set a consistent theme for "Audience Ready" style</span></span>
<span id="cb11-23"><a href="#cb11-23"></a>my_theme <span class="ot">&lt;-</span> <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb11-24"><a href="#cb11-24"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-25"><a href="#cb11-25"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb11-26"><a href="#cb11-26"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"grey30"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb11-27"><a href="#cb11-27"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb11-28"><a href="#cb11-28"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb11-29"><a href="#cb11-29"></a>  )</span>
<span id="cb11-30"><a href="#cb11-30"></a><span class="in">```</span></span>
<span id="cb11-31"><a href="#cb11-31"></a></span>
<span id="cb11-32"><a href="#cb11-32"></a><span class="fu">## 3.1 Physiological Signatures of Stress (WESAD)</span></span>
<span id="cb11-33"><a href="#cb11-33"></a></span>
<span id="cb11-34"><a href="#cb11-34"></a>We first analyze the WESAD dataset to establish a "ground truth" for what stress looks like physiologically compared to baseline and amusement states.</span>
<span id="cb11-35"><a href="#cb11-35"></a></span>
<span id="cb11-36"><a href="#cb11-36"></a><span class="fu">### EDA: The Primary Stress Indicator</span></span>
<span id="cb11-37"><a href="#cb11-37"></a></span>
<span id="cb11-38"><a href="#cb11-38"></a>Electrodermal Activity (EDA), also known as skin conductance, is a key indicator of physiological arousal. We expect stress to trigger significantly higher EDA levels.</span>
<span id="cb11-39"><a href="#cb11-39"></a></span>
<span id="cb11-42"><a href="#cb11-42"></a><span class="in">```{r}</span></span>
<span id="cb11-43"><a href="#cb11-43"></a><span class="co">#| label: eda-boxplot</span></span>
<span id="cb11-44"><a href="#cb11-44"></a><span class="co">#| fig.cap: "Comparison of EDA across conditions. Stress shows a higher median and wider interquartile range."</span></span>
<span id="cb11-45"><a href="#cb11-45"></a><span class="co">#| warning: false</span></span>
<span id="cb11-46"><a href="#cb11-46"></a></span>
<span id="cb11-47"><a href="#cb11-47"></a><span class="co"># Filter for key conditions (removing Meditation for clearer contrast)</span></span>
<span id="cb11-48"><a href="#cb11-48"></a>wesad_main <span class="ot">&lt;-</span> wesad <span class="sc">%&gt;%</span> </span>
<span id="cb11-49"><a href="#cb11-49"></a>  <span class="fu">filter</span>(Condition <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Baseline"</span>, <span class="st">"Stress"</span>, <span class="st">"Amusement"</span>))</span>
<span id="cb11-50"><a href="#cb11-50"></a></span>
<span id="cb11-51"><a href="#cb11-51"></a><span class="co"># Graph 1: EDA Boxplot</span></span>
<span id="cb11-52"><a href="#cb11-52"></a><span class="fu">ggplot</span>(wesad_main, <span class="fu">aes</span>(<span class="at">x =</span> Condition, <span class="at">y =</span> EDA, <span class="at">fill =</span> Condition)) <span class="sc">+</span></span>
<span id="cb11-53"><a href="#cb11-53"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.alpha =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb11-54"><a href="#cb11-54"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"RdBu"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-55"><a href="#cb11-55"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>)) <span class="sc">+</span> <span class="co"># Zoom in to ignore extreme outliers for better visibility</span></span>
<span id="cb11-56"><a href="#cb11-56"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-57"><a href="#cb11-57"></a>    <span class="at">title =</span> <span class="st">"Skin Conductance (EDA) by Condition"</span>,</span>
<span id="cb11-58"><a href="#cb11-58"></a>    <span class="at">subtitle =</span> <span class="st">"Stress elicits significantly higher EDA than Baseline"</span>,</span>
<span id="cb11-59"><a href="#cb11-59"></a>    <span class="at">y =</span> <span class="st">"EDA (μS)"</span>,</span>
<span id="cb11-60"><a href="#cb11-60"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb11-61"><a href="#cb11-61"></a>  ) <span class="sc">+</span></span>
<span id="cb11-62"><a href="#cb11-62"></a>  my_theme <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb11-63"><a href="#cb11-63"></a><span class="in">```</span></span>
<span id="cb11-64"><a href="#cb11-64"></a></span>
<span id="cb11-65"><a href="#cb11-65"></a><span class="fu">### Body Temperature Response</span></span>
<span id="cb11-66"><a href="#cb11-66"></a></span>
<span id="cb11-67"><a href="#cb11-67"></a>Does skin temperature drop or rise during stress? The "cold hands" phenomenon suggests a drop due to vasoconstriction, but metabolic activity might suggest a rise.</span>
<span id="cb11-68"><a href="#cb11-68"></a></span>
<span id="cb11-71"><a href="#cb11-71"></a><span class="in">```{r}</span></span>
<span id="cb11-72"><a href="#cb11-72"></a><span class="co">#| label: temp-violin</span></span>
<span id="cb11-73"><a href="#cb11-73"></a><span class="co">#| fig.cap: "Violin plot of Skin Temperature. Note the subtle shifts in distribution."</span></span>
<span id="cb11-74"><a href="#cb11-74"></a></span>
<span id="cb11-75"><a href="#cb11-75"></a><span class="co"># Graph 2: Temperature Violin Plot</span></span>
<span id="cb11-76"><a href="#cb11-76"></a><span class="fu">ggplot</span>(wesad_main, <span class="fu">aes</span>(<span class="at">x =</span> Condition, <span class="at">y =</span> Temp, <span class="at">fill =</span> Condition)) <span class="sc">+</span></span>
<span id="cb11-77"><a href="#cb11-77"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb11-78"><a href="#cb11-78"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> median, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb11-79"><a href="#cb11-79"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"RdBu"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-80"><a href="#cb11-80"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-81"><a href="#cb11-81"></a>    <span class="at">title =</span> <span class="st">"Skin Temperature Distribution"</span>,</span>
<span id="cb11-82"><a href="#cb11-82"></a>    <span class="at">subtitle =</span> <span class="st">"Temperature varies less dramatically than EDA"</span>,</span>
<span id="cb11-83"><a href="#cb11-83"></a>    <span class="at">y =</span> <span class="st">"Temperature (°C)"</span>,</span>
<span id="cb11-84"><a href="#cb11-84"></a>    <span class="at">x =</span> <span class="cn">NULL</span></span>
<span id="cb11-85"><a href="#cb11-85"></a>  ) <span class="sc">+</span></span>
<span id="cb11-86"><a href="#cb11-86"></a>  my_theme</span>
<span id="cb11-87"><a href="#cb11-87"></a><span class="in">```</span></span>
<span id="cb11-88"><a href="#cb11-88"></a></span>
<span id="cb11-89"><a href="#cb11-89"></a><span class="fu">## 3.2 Individual Variations in Heart Rate</span></span>
<span id="cb11-90"><a href="#cb11-90"></a></span>
<span id="cb11-91"><a href="#cb11-91"></a>Physiological responses are highly personal. A stressor that spikes one person's heart rate might not affect another's as severely. Here we use Ridge Plots to visualize the heart rate (ECG) distribution for each subject.</span>
<span id="cb11-92"><a href="#cb11-92"></a></span>
<span id="cb11-95"><a href="#cb11-95"></a><span class="in">```{r}</span></span>
<span id="cb11-96"><a href="#cb11-96"></a><span class="co">#| label: ecg-ridges</span></span>
<span id="cb11-97"><a href="#cb11-97"></a><span class="co">#| fig.height: 8</span></span>
<span id="cb11-98"><a href="#cb11-98"></a><span class="co">#| fig.cap: "ECG signal distributions for each subject. S2 and S3 show distinct shifts."</span></span>
<span id="cb11-99"><a href="#cb11-99"></a></span>
<span id="cb11-100"><a href="#cb11-100"></a><span class="co"># Graph 3: ECG Ridge Plot</span></span>
<span id="cb11-101"><a href="#cb11-101"></a><span class="fu">ggplot</span>(wesad_main, <span class="fu">aes</span>(<span class="at">x =</span> ECG, <span class="at">y =</span> Subject, <span class="at">fill =</span> Condition)) <span class="sc">+</span></span>
<span id="cb11-102"><a href="#cb11-102"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">scale =</span> <span class="fl">0.9</span>, <span class="at">rel_min_height =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb11-103"><a href="#cb11-103"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray70"</span>, <span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span>)) <span class="sc">+</span></span>
<span id="cb11-104"><a href="#cb11-104"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-105"><a href="#cb11-105"></a>    <span class="at">title =</span> <span class="st">"ECG Signal Distribution by Subject"</span>,</span>
<span id="cb11-106"><a href="#cb11-106"></a>    <span class="at">subtitle =</span> <span class="st">"Comparing Baseline (Gray), Stress (Red), and Amusement (Blue)"</span>,</span>
<span id="cb11-107"><a href="#cb11-107"></a>    <span class="at">x =</span> <span class="st">"ECG Amplitude (Normalized)"</span>,</span>
<span id="cb11-108"><a href="#cb11-108"></a>    <span class="at">y =</span> <span class="st">"Subject ID"</span></span>
<span id="cb11-109"><a href="#cb11-109"></a>  ) <span class="sc">+</span></span>
<span id="cb11-110"><a href="#cb11-110"></a>  <span class="fu">theme_ridges</span>() <span class="sc">+</span></span>
<span id="cb11-111"><a href="#cb11-111"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb11-112"><a href="#cb11-112"></a><span class="in">```</span></span>
<span id="cb11-113"><a href="#cb11-113"></a></span>
<span id="cb11-114"><a href="#cb11-114"></a><span class="fu">## 3.3 Real-World Context: Driving Stress</span></span>
<span id="cb11-115"><a href="#cb11-115"></a></span>
<span id="cb11-116"><a href="#cb11-116"></a>How does heart rate variability look in a real-world driving task? We analyze the AffectiveROAD dataset to see heart rate patterns during different driving sessions.</span>
<span id="cb11-117"><a href="#cb11-117"></a></span>
<span id="cb11-120"><a href="#cb11-120"></a><span class="in">```{r}</span></span>
<span id="cb11-121"><a href="#cb11-121"></a><span class="co">#| label: driving-hr</span></span>
<span id="cb11-122"><a href="#cb11-122"></a><span class="co">#| fig.cap: "Average Heart Rate across different driving sessions."</span></span>
<span id="cb11-123"><a href="#cb11-123"></a></span>
<span id="cb11-124"><a href="#cb11-124"></a><span class="co"># Graph 4: Driving HR Bar Chart</span></span>
<span id="cb11-125"><a href="#cb11-125"></a><span class="co"># Summarize data by DriveID</span></span>
<span id="cb11-126"><a href="#cb11-126"></a>road_summary <span class="ot">&lt;-</span> road <span class="sc">%&gt;%</span></span>
<span id="cb11-127"><a href="#cb11-127"></a>  <span class="fu">group_by</span>(DriveID) <span class="sc">%&gt;%</span></span>
<span id="cb11-128"><a href="#cb11-128"></a>  <span class="fu">summarise</span>(</span>
<span id="cb11-129"><a href="#cb11-129"></a>    <span class="at">Mean_HR =</span> <span class="fu">mean</span>(HR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-130"><a href="#cb11-130"></a>    <span class="at">SD_HR =</span> <span class="fu">sd</span>(HR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co"># SD is a proxy for HRV (Heart Rate Variability)</span></span>
<span id="cb11-131"><a href="#cb11-131"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb11-132"><a href="#cb11-132"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Mean_HR))</span>
<span id="cb11-133"><a href="#cb11-133"></a></span>
<span id="cb11-134"><a href="#cb11-134"></a><span class="fu">ggplot</span>(road_summary, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(DriveID, Mean_HR), <span class="at">y =</span> Mean_HR)) <span class="sc">+</span></span>
<span id="cb11-135"><a href="#cb11-135"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb11-136"><a href="#cb11-136"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Mean_HR <span class="sc">-</span> SD_HR, <span class="at">ymax =</span> Mean_HR <span class="sc">+</span> SD_HR), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb11-137"><a href="#cb11-137"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb11-138"><a href="#cb11-138"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-139"><a href="#cb11-139"></a>    <span class="at">title =</span> <span class="st">"Heart Rate during Driving Sessions"</span>,</span>
<span id="cb11-140"><a href="#cb11-140"></a>    <span class="at">subtitle =</span> <span class="st">"Error bars represent Standard Deviation (Proxy for HRV)"</span>,</span>
<span id="cb11-141"><a href="#cb11-141"></a>    <span class="at">y =</span> <span class="st">"Heart Rate (BPM)"</span>,</span>
<span id="cb11-142"><a href="#cb11-142"></a>    <span class="at">x =</span> <span class="st">"Driving Session"</span></span>
<span id="cb11-143"><a href="#cb11-143"></a>  ) <span class="sc">+</span></span>
<span id="cb11-144"><a href="#cb11-144"></a>  my_theme</span>
<span id="cb11-145"><a href="#cb11-145"></a><span class="in">```</span></span>
<span id="cb11-146"><a href="#cb11-146"></a></span>
<span id="cb11-147"><a href="#cb11-147"></a><span class="fu">## 3.4 Multi-modal Correlations</span></span>
<span id="cb11-148"><a href="#cb11-148"></a></span>
<span id="cb11-149"><a href="#cb11-149"></a>Do physiological signals synchronize during stress? We examine the correlation between Heart Rate (ECG), Skin Conductance (EDA), and Body Temperature (Temp) to see if they move in tandem.</span>
<span id="cb11-150"><a href="#cb11-150"></a></span>
<span id="cb11-153"><a href="#cb11-153"></a><span class="in">```{r}</span></span>
<span id="cb11-154"><a href="#cb11-154"></a><span class="co">#| label: correlation-heatmap</span></span>
<span id="cb11-155"><a href="#cb11-155"></a><span class="co">#| fig.cap: "Correlation Matrix of Physiological Signals. Red indicates positive correlation, Blue indicates negative."</span></span>
<span id="cb11-156"><a href="#cb11-156"></a></span>
<span id="cb11-157"><a href="#cb11-157"></a><span class="co"># 1. Select numeric physiological columns</span></span>
<span id="cb11-158"><a href="#cb11-158"></a>cor_data <span class="ot">&lt;-</span> wesad_main <span class="sc">%&gt;%</span></span>
<span id="cb11-159"><a href="#cb11-159"></a>  <span class="fu">select</span>(EDA, Temp, ECG)</span>
<span id="cb11-160"><a href="#cb11-160"></a></span>
<span id="cb11-161"><a href="#cb11-161"></a><span class="co"># 2. Compute correlation matrix</span></span>
<span id="cb11-162"><a href="#cb11-162"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(cor_data, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb11-163"><a href="#cb11-163"></a></span>
<span id="cb11-164"><a href="#cb11-164"></a><span class="co"># 3. Transform to long format for ggplot</span></span>
<span id="cb11-165"><a href="#cb11-165"></a>cor_melted <span class="ot">&lt;-</span> cor_matrix <span class="sc">%&gt;%</span></span>
<span id="cb11-166"><a href="#cb11-166"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-167"><a href="#cb11-167"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Var1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-168"><a href="#cb11-168"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Var1, <span class="at">names_to =</span> <span class="st">"Var2"</span>, <span class="at">values_to =</span> <span class="st">"Correlation"</span>)</span>
<span id="cb11-169"><a href="#cb11-169"></a></span>
<span id="cb11-170"><a href="#cb11-170"></a><span class="co"># 4. Plot Heatmap</span></span>
<span id="cb11-171"><a href="#cb11-171"></a><span class="fu">ggplot</span>(cor_melted, <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">fill =</span> Correlation)) <span class="sc">+</span></span>
<span id="cb11-172"><a href="#cb11-172"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb11-173"><a href="#cb11-173"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Correlation, <span class="dv">2</span>)), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb11-174"><a href="#cb11-174"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"#377EB8"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#E41A1C"</span>, </span>
<span id="cb11-175"><a href="#cb11-175"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb11-176"><a href="#cb11-176"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-177"><a href="#cb11-177"></a>    <span class="at">title =</span> <span class="st">"Correlation of Physiological Signals"</span>,</span>
<span id="cb11-178"><a href="#cb11-178"></a>    <span class="at">subtitle =</span> <span class="st">"EDA and Temperature show distinct relationship patterns compared to ECG"</span>,</span>
<span id="cb11-179"><a href="#cb11-179"></a>    <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span></span>
<span id="cb11-180"><a href="#cb11-180"></a>  ) <span class="sc">+</span></span>
<span id="cb11-181"><a href="#cb11-181"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-182"><a href="#cb11-182"></a>  <span class="fu">coord_fixed</span>()</span>
<span id="cb11-183"><a href="#cb11-183"></a><span class="in">```</span></span>
<span id="cb11-184"><a href="#cb11-184"></a></span>
<span id="cb11-185"><a href="#cb11-185"></a><span class="fu">## 3.5 Temporal Dynamics: Stress &amp; Recovery Rhythms</span></span>
<span id="cb11-186"><a href="#cb11-186"></a></span>
<span id="cb11-187"><a href="#cb11-187"></a>A key goal of this project is to explore the daily rhythms of stress. Here, we zoom in on a single subject (S2) to visualize how their physiological state evolves over time, transitioning from Baseline to Stress and finally to Amusement (Recovery).</span>
<span id="cb11-188"><a href="#cb11-188"></a></span>
<span id="cb11-191"><a href="#cb11-191"></a><span class="in">```{r}</span></span>
<span id="cb11-192"><a href="#cb11-192"></a><span class="co">#| label: time-series-s2</span></span>
<span id="cb11-193"><a href="#cb11-193"></a><span class="co">#| fig.width: 10</span></span>
<span id="cb11-194"><a href="#cb11-194"></a><span class="co">#| fig.height: 6</span></span>
<span id="cb11-195"><a href="#cb11-195"></a><span class="co">#| fig.cap: "Temporal evolution of EDA and Temperature for Subject S2. The shaded regions represent the Stress condition."</span></span>
<span id="cb11-196"><a href="#cb11-196"></a></span>
<span id="cb11-197"><a href="#cb11-197"></a><span class="co"># 1. Filter for Subject S2 and create a Time axis</span></span>
<span id="cb11-198"><a href="#cb11-198"></a><span class="co"># Since we downsampled to ~10Hz, each row is approx 0.1 seconds.</span></span>
<span id="cb11-199"><a href="#cb11-199"></a>subject_s2 <span class="ot">&lt;-</span> wesad <span class="sc">%&gt;%</span></span>
<span id="cb11-200"><a href="#cb11-200"></a>  <span class="fu">filter</span>(Subject <span class="sc">==</span> <span class="st">"S2"</span>, Condition <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Baseline"</span>, <span class="st">"Stress"</span>, <span class="st">"Amusement"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-201"><a href="#cb11-201"></a>  <span class="fu">mutate</span>(<span class="at">Time_Sec =</span> <span class="fu">row_number</span>() <span class="sc">/</span> <span class="dv">10</span>) <span class="co"># Create time in seconds</span></span>
<span id="cb11-202"><a href="#cb11-202"></a></span>
<span id="cb11-203"><a href="#cb11-203"></a><span class="co"># 2. Visualization</span></span>
<span id="cb11-204"><a href="#cb11-204"></a><span class="co"># We want to highlight the "Stress" period. </span></span>
<span id="cb11-205"><a href="#cb11-205"></a><span class="co"># Let's plot EDA over time, coloring the line by Condition.</span></span>
<span id="cb11-206"><a href="#cb11-206"></a></span>
<span id="cb11-207"><a href="#cb11-207"></a><span class="fu">ggplot</span>(subject_s2, <span class="fu">aes</span>(<span class="at">x =</span> Time_Sec, <span class="at">y =</span> EDA, <span class="at">color =</span> Condition)) <span class="sc">+</span></span>
<span id="cb11-208"><a href="#cb11-208"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb11-209"><a href="#cb11-209"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Baseline"</span> <span class="ot">=</span> <span class="st">"gray50"</span>, <span class="st">"Stress"</span> <span class="ot">=</span> <span class="st">"#E41A1C"</span>, <span class="st">"Amusement"</span> <span class="ot">=</span> <span class="st">"#377EB8"</span>)) <span class="sc">+</span></span>
<span id="cb11-210"><a href="#cb11-210"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-211"><a href="#cb11-211"></a>    <span class="at">title =</span> <span class="st">"Physiological Stress Response Over Time (Subject S2)"</span>,</span>
<span id="cb11-212"><a href="#cb11-212"></a>    <span class="at">subtitle =</span> <span class="st">"Tracking Electrodermal Activity (EDA) through different experimental phases"</span>,</span>
<span id="cb11-213"><a href="#cb11-213"></a>    <span class="at">x =</span> <span class="st">"Time (seconds)"</span>,</span>
<span id="cb11-214"><a href="#cb11-214"></a>    <span class="at">y =</span> <span class="st">"Skin Conductance (μS)"</span>,</span>
<span id="cb11-215"><a href="#cb11-215"></a>    <span class="at">caption =</span> <span class="st">"Red indicates the Stress phase, clearly marked by a surge in EDA."</span></span>
<span id="cb11-216"><a href="#cb11-216"></a>  ) <span class="sc">+</span></span>
<span id="cb11-217"><a href="#cb11-217"></a>  my_theme <span class="sc">+</span></span>
<span id="cb11-218"><a href="#cb11-218"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb11-219"><a href="#cb11-219"></a><span class="in">```</span></span>
<span id="cb11-220"><a href="#cb11-220"></a></span>
<span id="cb11-221"><a href="#cb11-221"></a><span class="fu">## 3.6 Comparison with Office Stress (SWELL)</span></span>
<span id="cb11-222"><a href="#cb11-222"></a></span>
<span id="cb11-223"><a href="#cb11-223"></a>Finally, we briefly examine the SWELL-KW dataset to understand the feature distribution in an office setting.</span>
<span id="cb11-224"><a href="#cb11-224"></a></span>
<span id="cb11-227"><a href="#cb11-227"></a><span class="in">```{r}</span></span>
<span id="cb11-228"><a href="#cb11-228"></a><span class="co">#| label: swell-overview</span></span>
<span id="cb11-229"><a href="#cb11-229"></a><span class="co">#| warning: false</span></span>
<span id="cb11-230"><a href="#cb11-230"></a><span class="co">#| message: false</span></span>
<span id="cb11-231"><a href="#cb11-231"></a></span>
<span id="cb11-232"><a href="#cb11-232"></a><span class="co"># Quick inspection of SWELL dataset features</span></span>
<span id="cb11-233"><a href="#cb11-233"></a><span class="co"># We select numeric columns that might represent heart rate or skin conductance</span></span>
<span id="cb11-234"><a href="#cb11-234"></a><span class="co"># Note: SWELL column names depend on the specific feature set used. </span></span>
<span id="cb11-235"><a href="#cb11-235"></a><span class="co"># Here we visualize the first few available numeric columns as an exploratory step.</span></span>
<span id="cb11-236"><a href="#cb11-236"></a></span>
<span id="cb11-237"><a href="#cb11-237"></a><span class="co"># Select only numeric columns for a quick overview</span></span>
<span id="cb11-238"><a href="#cb11-238"></a>swell_numeric <span class="ot">&lt;-</span> swell <span class="sc">%&gt;%</span></span>
<span id="cb11-239"><a href="#cb11-239"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb11-240"><a href="#cb11-240"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Feature"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-241"><a href="#cb11-241"></a>  <span class="co"># Just pick top 4 features to plot to avoid overcrowding</span></span>
<span id="cb11-242"><a href="#cb11-242"></a>  <span class="fu">filter</span>(Feature <span class="sc">%in%</span> <span class="fu">unique</span>(Feature)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb11-243"><a href="#cb11-243"></a></span>
<span id="cb11-244"><a href="#cb11-244"></a><span class="fu">ggplot</span>(swell_numeric, <span class="fu">aes</span>(<span class="at">x =</span> Value)) <span class="sc">+</span></span>
<span id="cb11-245"><a href="#cb11-245"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"forestgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb11-246"><a href="#cb11-246"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Feature, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb11-247"><a href="#cb11-247"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-248"><a href="#cb11-248"></a>    <span class="at">title =</span> <span class="st">"Feature Distributions in SWELL (Office) Dataset"</span>,</span>
<span id="cb11-249"><a href="#cb11-249"></a>    <span class="at">subtitle =</span> <span class="st">"Exploratory histograms of physiological/behavioral features"</span>,</span>
<span id="cb11-250"><a href="#cb11-250"></a>    <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb11-251"><a href="#cb11-251"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb11-252"><a href="#cb11-252"></a>  ) <span class="sc">+</span></span>
<span id="cb11-253"><a href="#cb11-253"></a>  my_theme</span>
<span id="cb11-254"><a href="#cb11-254"></a><span class="in">```</span></span>
<span id="cb11-255"><a href="#cb11-255"></a><span class="fu">## 3.7 Multidimensional Stress Separation</span></span>
<span id="cb11-256"><a href="#cb11-256"></a></span>
<span id="cb11-257"><a href="#cb11-257"></a>Can we distinguish "Stress" from "Baseline" by examining multiple physiological signals simultaneously? Here we visualize the **2D feature space** plotting Temperature against EDA to reveal how stress occupies a distinct physiological region.</span>
<span id="cb11-258"><a href="#cb11-258"></a></span>
<span id="cb11-261"><a href="#cb11-261"></a><span class="in">```{r}</span></span>
<span id="cb11-262"><a href="#cb11-262"></a><span class="co">#| label: feature-scatter</span></span>
<span id="cb11-263"><a href="#cb11-263"></a><span class="co">#| fig.width: 10</span></span>
<span id="cb11-264"><a href="#cb11-264"></a><span class="co">#| fig.height: 7</span></span>
<span id="cb11-265"><a href="#cb11-265"></a><span class="co">#| fig.cap: "Scatter plot of Skin Temperature vs. EDA. Stress (Red) clusters in a distinct region with elevated EDA levels."</span></span>
<span id="cb11-266"><a href="#cb11-266"></a></span>
<span id="cb11-267"><a href="#cb11-267"></a><span class="co"># Create 2D scatter plot with density contours</span></span>
<span id="cb11-268"><a href="#cb11-268"></a><span class="fu">ggplot</span>(wesad_main, <span class="fu">aes</span>(<span class="at">x =</span> Temp, <span class="at">y =</span> EDA, <span class="at">color =</span> Condition)) <span class="sc">+</span></span>
<span id="cb11-269"><a href="#cb11-269"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb11-270"><a href="#cb11-270"></a>  <span class="fu">stat_ellipse</span>(<span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb11-271"><a href="#cb11-271"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb11-272"><a href="#cb11-272"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Baseline"</span> <span class="ot">=</span> <span class="st">"#4DAF4A"</span>, <span class="st">"Stress"</span> <span class="ot">=</span> <span class="st">"#E41A1C"</span>, <span class="st">"Amusement"</span> <span class="ot">=</span> <span class="st">"#377EB8"</span>),</span>
<span id="cb11-273"><a href="#cb11-273"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Baseline (Calm)"</span>, <span class="st">"Stress (Aroused)"</span>, <span class="st">"Amusement (Relaxed)"</span>)</span>
<span id="cb11-274"><a href="#cb11-274"></a>  ) <span class="sc">+</span></span>
<span id="cb11-275"><a href="#cb11-275"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-276"><a href="#cb11-276"></a>    <span class="at">title =</span> <span class="st">"Physiological Feature Space: Temperature vs. EDA"</span>,</span>
<span id="cb11-277"><a href="#cb11-277"></a>    <span class="at">subtitle =</span> <span class="st">"Stress is characterized by elevated EDA with moderate temperature variation"</span>,</span>
<span id="cb11-278"><a href="#cb11-278"></a>    <span class="at">x =</span> <span class="st">"Skin Temperature (°C)"</span>,</span>
<span id="cb11-279"><a href="#cb11-279"></a>    <span class="at">y =</span> <span class="st">"Electrodermal Activity (μS)"</span>,</span>
<span id="cb11-280"><a href="#cb11-280"></a>    <span class="at">color =</span> <span class="st">"Experimental Condition"</span></span>
<span id="cb11-281"><a href="#cb11-281"></a>  ) <span class="sc">+</span></span>
<span id="cb11-282"><a href="#cb11-282"></a>  my_theme <span class="sc">+</span></span>
<span id="cb11-283"><a href="#cb11-283"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-284"><a href="#cb11-284"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb11-285"><a href="#cb11-285"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb11-286"><a href="#cb11-286"></a>  ) <span class="sc">+</span></span>
<span id="cb11-287"><a href="#cb11-287"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>)))</span>
<span id="cb11-288"><a href="#cb11-288"></a><span class="in">```</span></span>
<span id="cb11-289"><a href="#cb11-289"></a></span>
<span id="cb11-290"><a href="#cb11-290"></a><span class="fu">### Interpretation</span></span>
<span id="cb11-291"><a href="#cb11-291"></a></span>
<span id="cb11-292"><a href="#cb11-292"></a>The scatter plot reveals clear **clustering patterns** in the physiological feature space:</span>
<span id="cb11-293"><a href="#cb11-293"></a></span>
<span id="cb11-294"><a href="#cb11-294"></a><span class="ss">- </span>**Stress (Red)**: High EDA values (&gt;5 μS) with temperature clustered around 32-34°C</span>
<span id="cb11-295"><a href="#cb11-295"></a><span class="ss">- </span>**Baseline (Green)**: Lower EDA (&lt;5 μS) and slightly cooler temperature</span>
<span id="cb11-296"><a href="#cb11-296"></a><span class="ss">- </span>**Amusement (Blue)**: Moderate EDA with the widest temperature distribution</span>
<span id="cb11-297"><a href="#cb11-297"></a></span>
<span id="cb11-298"><a href="#cb11-298"></a>The 95% confidence ellipses show minimal overlap between Stress and Baseline, suggesting these signals could effectively classify stress states in a machine learning model.</span>
<span id="cb11-299"><a href="#cb11-299"></a></span>
<span id="cb11-300"><a href="#cb11-300"></a>---</span>
<span id="cb11-301"><a href="#cb11-301"></a></span>
<span id="cb11-302"><a href="#cb11-302"></a><span class="fu">## 3.8 Cross-Context Comparison: Laboratory vs. Real-World</span></span>
<span id="cb11-303"><a href="#cb11-303"></a></span>
<span id="cb11-304"><a href="#cb11-304"></a>How do physiological responses differ between controlled laboratory settings and naturalistic environments? We compare heart rate patterns from the WESAD lab study with the AffectiveROAD driving dataset.</span>
<span id="cb11-305"><a href="#cb11-305"></a></span>
<span id="cb11-308"><a href="#cb11-308"></a><span class="in">```{r}</span></span>
<span id="cb11-309"><a href="#cb11-309"></a><span class="co">#| label: cross-context-comparison</span></span>
<span id="cb11-310"><a href="#cb11-310"></a><span class="co">#| fig.width: 12</span></span>
<span id="cb11-311"><a href="#cb11-311"></a><span class="co">#| fig.height: 6</span></span>
<span id="cb11-312"><a href="#cb11-312"></a><span class="co">#| fig.cap: "Distribution comparison: Laboratory ECG (WESAD) vs. Real-world Heart Rate (Driving)"</span></span>
<span id="cb11-313"><a href="#cb11-313"></a><span class="co">#| warning: false</span></span>
<span id="cb11-314"><a href="#cb11-314"></a></span>
<span id="cb11-315"><a href="#cb11-315"></a><span class="co"># Prepare lab data (WESAD ECG - proxy for heart activity)</span></span>
<span id="cb11-316"><a href="#cb11-316"></a>lab_data <span class="ot">&lt;-</span> wesad_main <span class="sc">%&gt;%</span> </span>
<span id="cb11-317"><a href="#cb11-317"></a>  <span class="fu">filter</span>(Condition <span class="sc">==</span> <span class="st">"Stress"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-318"><a href="#cb11-318"></a>  <span class="fu">select</span>(ECG) <span class="sc">%&gt;%</span> </span>
<span id="cb11-319"><a href="#cb11-319"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-320"><a href="#cb11-320"></a>    <span class="at">Context =</span> <span class="st">"Laboratory (WESAD)"</span>,</span>
<span id="cb11-321"><a href="#cb11-321"></a>    <span class="at">Signal_Type =</span> <span class="st">"ECG Amplitude"</span></span>
<span id="cb11-322"><a href="#cb11-322"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb11-323"><a href="#cb11-323"></a>  <span class="fu">rename</span>(<span class="at">Value =</span> ECG)</span>
<span id="cb11-324"><a href="#cb11-324"></a></span>
<span id="cb11-325"><a href="#cb11-325"></a><span class="co"># Prepare real-world data (AffectiveROAD Heart Rate)</span></span>
<span id="cb11-326"><a href="#cb11-326"></a>realworld_data <span class="ot">&lt;-</span> road <span class="sc">%&gt;%</span> </span>
<span id="cb11-327"><a href="#cb11-327"></a>  <span class="fu">select</span>(HR) <span class="sc">%&gt;%</span> </span>
<span id="cb11-328"><a href="#cb11-328"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-329"><a href="#cb11-329"></a>    <span class="at">Context =</span> <span class="st">"Real-World (Driving)"</span>,</span>
<span id="cb11-330"><a href="#cb11-330"></a>    <span class="at">Signal_Type =</span> <span class="st">"Heart Rate (BPM)"</span></span>
<span id="cb11-331"><a href="#cb11-331"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb11-332"><a href="#cb11-332"></a>  <span class="fu">rename</span>(<span class="at">Value =</span> HR) <span class="sc">%&gt;%</span></span>
<span id="cb11-333"><a href="#cb11-333"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Value))</span>
<span id="cb11-334"><a href="#cb11-334"></a></span>
<span id="cb11-335"><a href="#cb11-335"></a><span class="co"># Combine datasets</span></span>
<span id="cb11-336"><a href="#cb11-336"></a>comparison_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(lab_data, realworld_data)</span>
<span id="cb11-337"><a href="#cb11-337"></a></span>
<span id="cb11-338"><a href="#cb11-338"></a><span class="co"># Create side-by-side density plots</span></span>
<span id="cb11-339"><a href="#cb11-339"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(comparison_data, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Context)) <span class="sc">+</span></span>
<span id="cb11-340"><a href="#cb11-340"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-341"><a href="#cb11-341"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Laboratory (WESAD)"</span> <span class="ot">=</span> <span class="st">"#FF6B6B"</span>, </span>
<span id="cb11-342"><a href="#cb11-342"></a>                                 <span class="st">"Real-World (Driving)"</span> <span class="ot">=</span> <span class="st">"#4ECDC4"</span>)) <span class="sc">+</span></span>
<span id="cb11-343"><a href="#cb11-343"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Context, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb11-344"><a href="#cb11-344"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-345"><a href="#cb11-345"></a>    <span class="at">title =</span> <span class="st">"Physiological Signal Distributions: Lab vs. Real-World Contexts"</span>,</span>
<span id="cb11-346"><a href="#cb11-346"></a>    <span class="at">subtitle =</span> <span class="st">"Comparing controlled stress induction (WESAD) with naturalistic driving stress (AffectiveROAD)"</span>,</span>
<span id="cb11-347"><a href="#cb11-347"></a>    <span class="at">x =</span> <span class="st">"Signal Value (context-specific units)"</span>,</span>
<span id="cb11-348"><a href="#cb11-348"></a>    <span class="at">y =</span> <span class="st">"Probability Density"</span>,</span>
<span id="cb11-349"><a href="#cb11-349"></a>    <span class="at">caption =</span> <span class="st">"Note: Different measurement modalities (ECG vs. HR) and units - focus on distribution shape"</span></span>
<span id="cb11-350"><a href="#cb11-350"></a>  ) <span class="sc">+</span></span>
<span id="cb11-351"><a href="#cb11-351"></a>  my_theme <span class="sc">+</span></span>
<span id="cb11-352"><a href="#cb11-352"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-353"><a href="#cb11-353"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb11-354"><a href="#cb11-354"></a>    <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"gray90"</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb11-355"><a href="#cb11-355"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb11-356"><a href="#cb11-356"></a>  )</span>
<span id="cb11-357"><a href="#cb11-357"></a></span>
<span id="cb11-358"><a href="#cb11-358"></a><span class="fu">print</span>(p1)</span>
<span id="cb11-359"><a href="#cb11-359"></a><span class="in">```</span></span>
<span id="cb11-360"><a href="#cb11-360"></a></span>
<span id="cb11-361"><a href="#cb11-361"></a><span class="fu">### Context-Specific Insights</span></span>
<span id="cb11-362"><a href="#cb11-362"></a></span>
<span id="cb11-365"><a href="#cb11-365"></a><span class="in">```{r}</span></span>
<span id="cb11-366"><a href="#cb11-366"></a><span class="co">#| label: context-statistics</span></span>
<span id="cb11-367"><a href="#cb11-367"></a><span class="co">#| echo: false</span></span>
<span id="cb11-368"><a href="#cb11-368"></a></span>
<span id="cb11-369"><a href="#cb11-369"></a><span class="co"># Calculate summary statistics</span></span>
<span id="cb11-370"><a href="#cb11-370"></a>lab_stats <span class="ot">&lt;-</span> lab_data <span class="sc">%&gt;%</span></span>
<span id="cb11-371"><a href="#cb11-371"></a>  <span class="fu">summarise</span>(</span>
<span id="cb11-372"><a href="#cb11-372"></a>    <span class="at">Mean =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-373"><a href="#cb11-373"></a>    <span class="at">SD =</span> <span class="fu">sd</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-374"><a href="#cb11-374"></a>    <span class="at">Median =</span> <span class="fu">median</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-375"><a href="#cb11-375"></a>    <span class="at">IQR =</span> <span class="fu">IQR</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-376"><a href="#cb11-376"></a>  )</span>
<span id="cb11-377"><a href="#cb11-377"></a></span>
<span id="cb11-378"><a href="#cb11-378"></a>road_stats <span class="ot">&lt;-</span> realworld_data <span class="sc">%&gt;%</span></span>
<span id="cb11-379"><a href="#cb11-379"></a>  <span class="fu">summarise</span>(</span>
<span id="cb11-380"><a href="#cb11-380"></a>    <span class="at">Mean =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-381"><a href="#cb11-381"></a>    <span class="at">SD =</span> <span class="fu">sd</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-382"><a href="#cb11-382"></a>    <span class="at">Median =</span> <span class="fu">median</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-383"><a href="#cb11-383"></a>    <span class="at">IQR =</span> <span class="fu">IQR</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-384"><a href="#cb11-384"></a>  )</span>
<span id="cb11-385"><a href="#cb11-385"></a></span>
<span id="cb11-386"><a href="#cb11-386"></a><span class="co"># Display as a comparison table</span></span>
<span id="cb11-387"><a href="#cb11-387"></a>comparison_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-388"><a href="#cb11-388"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"Mean"</span>, <span class="st">"Std Dev"</span>, <span class="st">"Median"</span>, <span class="st">"IQR"</span>),</span>
<span id="cb11-389"><a href="#cb11-389"></a>  <span class="at">Laboratory =</span> <span class="fu">c</span>(</span>
<span id="cb11-390"><a href="#cb11-390"></a>    <span class="fu">round</span>(lab_stats<span class="sc">$</span>Mean, <span class="dv">2</span>),</span>
<span id="cb11-391"><a href="#cb11-391"></a>    <span class="fu">round</span>(lab_stats<span class="sc">$</span>SD, <span class="dv">2</span>),</span>
<span id="cb11-392"><a href="#cb11-392"></a>    <span class="fu">round</span>(lab_stats<span class="sc">$</span>Median, <span class="dv">2</span>),</span>
<span id="cb11-393"><a href="#cb11-393"></a>    <span class="fu">round</span>(lab_stats<span class="sc">$</span>IQR, <span class="dv">2</span>)</span>
<span id="cb11-394"><a href="#cb11-394"></a>  ),</span>
<span id="cb11-395"><a href="#cb11-395"></a>  <span class="at">Real_World =</span> <span class="fu">c</span>(</span>
<span id="cb11-396"><a href="#cb11-396"></a>    <span class="fu">round</span>(road_stats<span class="sc">$</span>Mean, <span class="dv">2</span>),</span>
<span id="cb11-397"><a href="#cb11-397"></a>    <span class="fu">round</span>(road_stats<span class="sc">$</span>SD, <span class="dv">2</span>),</span>
<span id="cb11-398"><a href="#cb11-398"></a>    <span class="fu">round</span>(road_stats<span class="sc">$</span>Median, <span class="dv">2</span>),</span>
<span id="cb11-399"><a href="#cb11-399"></a>    <span class="fu">round</span>(road_stats<span class="sc">$</span>IQR, <span class="dv">2</span>)</span>
<span id="cb11-400"><a href="#cb11-400"></a>  )</span>
<span id="cb11-401"><a href="#cb11-401"></a>)</span>
<span id="cb11-402"><a href="#cb11-402"></a></span>
<span id="cb11-403"><a href="#cb11-403"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(comparison_table, </span>
<span id="cb11-404"><a href="#cb11-404"></a>             <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Statistic"</span>, <span class="st">"Lab (ECG)"</span>, <span class="st">"Driving (HR)"</span>),</span>
<span id="cb11-405"><a href="#cb11-405"></a>             <span class="at">caption =</span> <span class="st">"Descriptive Statistics by Context"</span>)</span>
<span id="cb11-406"><a href="#cb11-406"></a><span class="in">```</span></span>
<span id="cb11-407"><a href="#cb11-407"></a></span>
<span id="cb11-408"><a href="#cb11-408"></a>**Key Findings:**</span>
<span id="cb11-409"><a href="#cb11-409"></a></span>
<span id="cb11-410"><a href="#cb11-410"></a><span class="ss">- </span>**Laboratory stress** (WESAD) shows more uniform distributions due to controlled experimental protocols</span>
<span id="cb11-411"><a href="#cb11-411"></a><span class="ss">- </span>**Real-world driving** exhibits higher variability, reflecting diverse traffic conditions and individual driving styles</span>
<span id="cb11-412"><a href="#cb11-412"></a><span class="ss">- </span>Both contexts demonstrate elevated physiological arousal, but with distinct signal characteristics</span>
<span id="cb11-413"><a href="#cb11-413"></a></span>
<span id="cb11-414"><a href="#cb11-414"></a>This comparison highlights the importance of validating stress detection models across multiple contexts - what works in the lab may require adaptation for real-world deployment.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2023 Yan Li (EDAV Final Project)</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/yanzzzk/edav-final-project/edit/main/results.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/yanzzzk/edav-final-project/blob/main/results.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>